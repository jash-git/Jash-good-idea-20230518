(self.mfeModules=self.mfeModules||[]).push(["",["Platform","React","ReactRedux","Redux","PlatformApi","FeatureToggles","WithInjectReducer","ReactRouter","ReactDom","ShopeeDefaultFooter","Experiments","ShopeeDefaultHeader","ReactHelmet","Account","NebulaCore"],(e,r,o,s,c,t,n,E,_,u,i,h,a,p,d)=>()=>{(self.wpJsonpPcmallPcpagevoucherdetail=self.wpJsonpPcmallPcpagevoucherdetail||[]).push([[846],{76676:(e,r,o)=>{"use strict";o.d(r,{t:()=>C});var s=o(63804),c=o.n(s),t=o(27107),n=o(99045),E=o(98750),_=o(35540),u=o(71574),i=o(62258);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},h.apply(this,arguments)}const{SAVE_VOUCHER:a}=_,p=(0,t.Z)({[E.Au.REQUESTED]:(e,r)=>{const{shopId:o,itemId:s}=r,c=s?{[s]:{vouchers:e.shop&&e.shop[o]&&e.shop[o][s]&&e.shop[o][s].vouchers||[],error:-100}}:{};return h({},e,{shop:h({},e.shop,{[o]:h({},e.shop[o],!s&&{error:-100}||{},c)})})},[E.Au.SUCCESS]:(e,r)=>{const{data:o,shopId:s,itemId:c,priorityVoucherList:t}=r;return h({},e,{shop:h({},e.shop,!c&&{[s]:{error:0,vouchers:o&&o.voucher_list||[],priorityVoucherList:t}}||{},c&&e.shop&&{[s]:h({},e.shop[s],{[c]:{vouchers:o&&o.voucher_list||[],error:0}})})})},[E.Au.FAILED]:(e,r)=>{const{shopId:o,error:s,itemId:c}=r;return h({},e,{shop:h({},e.shop,!c&&{[o]:{error:s,vouchers:[]}}||{},{error:s},c&&e.shop&&{[o]:h({},e.shop[o],{[c]:{vouchers:[],error:s}})})})},[E.rQ.REQUESTED]:(e,r)=>{const o=r;return h({},e,{recommendedShopVouchers:h({},e.recommendedShopVouchers,{progress:n.Z.REQ}),shop:h({},e.shop,{[o.shopId]:{vouchers:[],error:-100}})})},[E.rQ.FAILED]:(e,r)=>{const o=r;return h({},e,{recommendedShopVouchers:h({},e.recommendedShopVouchers,{progress:n.Z.ERR,error:o.error,error_msg:o.error_msg}),shop:h({},e.shop,{[o.shopId]:h({},e.shop[o.shopId],{error:o.error})})})},[E.rQ.SUCCESS]:(e,r)=>{const{data:{shop_vouchers:o},shopId:s,isCheckout:c}=r;return h({},e,{recommendedShopVouchers:h({},e.recommendedShopVouchers,{[s]:(o||[]).filter((e=>{var r,o;return!c&&![u.i8.NOT_COMPLETE_TASK].includes(null!=(r=e.invalid_message_code)?r:-1/0)||!u.j4.includes(null!=(o=e.invalid_message_code)?o:-1/0)})),progress:n.Z.OK}),shop:h({},e.shop,{[s]:h({},e.shop[s],{error:0})})})},[a.FAILED]:(e,r)=>{const{payload:{error:o,error_msg:s,error_config:c,voucher_code:t}}=r;return h({},e,{claimProgress:h({},e.claimProgress,{[t]:{progress:o===u.o$?n.Z.OK:n.Z.ERR,error:o,error_msg:s,error_config:c}})})},[a.SUCCESS]:(e,r)=>{const o=r,s=o.payload.voucher&&o.payload.voucher.shop_id,{voucher_code:c,voucher_promotionid:t,voucher:E}=o.payload;let _=e.shop;const u=(0,i.hy)(e,c,t?String(t):null);if(s){const r=e.shop[s],c=(r&&r.vouchers||[]).map((e=>e.voucher_code===o.payload.voucher_code?h({},e,{is_claimed_before:!0}):e));_=h({},_,{[s]:h({},r,{vouchers:[...c]})})}return h({},e,{shop:h({},_),claimProgress:h({},e.claimProgress,{[o.payload.voucher_code]:{progress:n.Z.OK}}),voucherDetail:{[c||"0"]:{[t]:h({},u,{voucher_basic_info:u.voucher_basic_info||E?h({},u.voucher_basic_info,E):null,progress:n.Z.OK})}}})},[a.REQUESTED]:(e,r)=>{const o=r;return h({},e,{claimProgress:h({},e.claimProgress,{[o.payload.voucher_code]:{progress:n.Z.REQ}})})},[E.cI.REQUESTED]:(e,r)=>{const o=r;return h({},e,{claimProgress:h({},e.claimProgress,{[o.voucher_code]:{progress:n.Z.REQ}})})},[E.cI.SUCCESS]:(e,r)=>{const{voucher_code:o,invalid_message_code:s,shopid:c}=r,t=!s||s===u.eg.CLAIM_ERROR_EXIST,E=c;let _=e.shop;if(E){const r=e.shop[E],s=(r&&r.vouchers||[]).map((e=>e.voucher_code===o?h({},e,{is_claimed_before:t}):e));_=h({},_,{[E]:h({},r,{vouchers:[...s]})})}return h({},e,{shop:h({},_),claimProgress:h({},e.claimProgress,{[o]:{progress:t?n.Z.OK:n.Z.ERR,invalid_message_code:s}})})},[E.cI.FAILED]:(e,r)=>{const o=r,{error:s}=o;return h({},e,{claimProgress:h({},e.claimProgress,{[o.voucher_code]:{progress:s===u.o$?n.Z.OK:n.Z.ERR,error:s,error_msg:o.error_msg}})})},[E.XB.REQUESTED]:(e,r)=>{const o=r;return h({},e,{claimProgress:h({},e.claimProgress,{[o.voucher_code]:{progress:n.Z.REQ}})})},[E.XB.SUCCESS]:(e,r)=>{const o=r,s=o.shopid;let c=e.shop;if(o.voucher&&s){const r=e.shop[s],t=(r&&r.vouchers||[]).map((e=>e.voucher_code===o.voucher_code?h({},e,{is_claimed_before:!0}):e));c=h({},c,{[s]:h({},r,{vouchers:[...t]})})}return h({},e,{shop:h({},c),claimProgress:h({},e.claimProgress,{[o.voucher_code]:{progress:o.voucher?n.Z.OK:n.Z.ERR}})})},[E.XB.FAILED]:(e,r)=>{const{error:o,error_msg:s,error_config:c,voucher_code:t,invalid_message_code:E}=r;return h({},e,{claimProgress:h({},e.claimProgress,{[t]:{progress:o===u.o$?n.Z.OK:n.Z.ERR,error:o,error_msg:s,error_config:c,invalid_message_code:E}})})},[E.KW]:(e,r)=>{const{voucher:o}=r,{shop_id:s}=o;return s?h({},e,{recommendedShopVouchers:h({},e.recommendedShopVouchers,{[s]:[o,...e.recommendedShopVouchers[s].filter((e=>e.voucher_code!==o.voucher_code))]})}):e},[E.Ec]:(e,r)=>{const{voucher:o}=r,{shop_id:s}=o;return s?h({},e,{recommendedShopVouchers:h({},e.recommendedShopVouchers,{[s]:e.recommendedShopVouchers[s].filter((e=>e.voucher_code!==o.voucher_code))})}):e},[E.mk]:(e,r)=>{const{voucher:o}=r,{shop_id:s}=o;return s?h({},e,{recommendedShopVouchers:h({},e.recommendedShopVouchers,{[s]:e.recommendedShopVouchers[s].map((e=>e.voucher_code===o.voucher_code?o:e))})}):e},[E.Js]:(e,r)=>{const{voucher:{voucher_code:o}}=r;return o?h({},e,{claimProgress:h({},e.claimProgress,{[o]:{progress:n.Z.OK}})}):e},[E._U.SUCCESS]:(e,r)=>{const o={};return r.data.forEach((r=>{const s=e.shop[r.shopid];var c,t;o[r.shopid]={error:0,vouchers:(c=s&&s.vouchers,t=r.voucher_list,t.map((e=>h({},e,{is_claimed_before:c&&c.some((r=>r.voucher_promotionid===e.voucher_promotionid&&r.is_claimed_before))}))))}})),h({},e,{shop:h({},e.shop,o)})},[E.u7.REQUESTED]:(e,r)=>{const{promotionid:o,voucher_code:s}=r;return h({},e,{voucherDetail:{[s||"0"]:{[o]:{progress:n.Z.REQ}}}})},[E.u7.SUCCESS]:(e,r)=>{const{data:o,promotionid:s,voucher_code:c}=r;return h({},e,{voucherDetail:{[c||"0"]:h({},e.voucherDetail[c],{[s]:h({},o,{progress:n.Z.OK,error:void 0,error_msg:void 0})})}})},[E.u7.FAILED]:(e,r)=>{const{error:o,promotionid:s,voucher_code:c,error_msg:t}=r;return h({},e,{voucherDetail:{[c||"0"]:h({},e.voucherDetail[c],{[s]:{error:o,progress:n.Z.ERR,error_msg:t}})},error:o||-1})}},{shop:{},claimProgress:{},voucherDetail:{},recommendedShopVouchers:{}});var d=o(57762);const l=["injectAsyncReducer"];function C(e){function r(r){const{injectAsyncReducer:o}=r,s=function(e,r){if(null==e)return{};var o,s,c={},t=Object.keys(e);for(s=0;s<t.length;s++)o=t[s],r.indexOf(o)>=0||(c[o]=e[o]);return c}(r,l);return c().useEffect((()=>{o({voucher:p})}),[o]),c().createElement(e,s)}return r.displayName=`withVoucherReduxInjected(${function(e){return e.displayName||e.name||"Component"}(e)})`,(0,d.withInjectReducer)(r)}},49209:(e,r,o)=>{"use strict";o.d(r,{N:()=>_});var s=o(63804),c=o(95325),t=o(99045),n=o(62258);const E={progress:t.Z.INIT};function _({shopId:e,onFirstVoucherChange:r,onFirstVoucherClaimProgressChange:o}){const t=(0,c.useSelector)((r=>{return(o=(0,n.zq)(r.voucher,e))&&o.length?o[0]:null;var o})),_=(0,c.useSelector)((e=>t&&t.voucher_code&&e.voucher.claimProgress[t.voucher_code]||E));(0,s.useEffect)((()=>{null==r||r(t)}),[t,r]),(0,s.useEffect)((()=>{null==o||o(_)}),[_,o])}},35540:(e,r,o)=>{"use strict";o.r(r),o.d(r,{FETCH_TABS:()=>c,FETCH_VOUCHERS:()=>t,FETCH_RECOMMEND_VOUCHERS:()=>n,VALIDATE_VOUCHERS:()=>E,ADD_RECOMMEND_VOUCHERS:()=>_,MOVE_RECOMMEND_VOUCHER_TO_TOP:()=>u,FETCH_PARTNER_VOUCHERS:()=>i,MARK_PARTNER_VOUCHER:()=>h,SAVE_VOUCHER:()=>a,FETCH_VOUCHER:()=>p,FETCH_BATCH_VOUCHER:()=>d,FETCH_BATCH_VOUCHER_LEGACY:()=>l,CREATE_BATCH_VOUCHER_REQ:()=>C,FETCH_REDEEMED_VOUCHER_BY_TIME:()=>m,CREATE_FETCH_REDEEMED_VOUCHER_BY_TIME_REQ:()=>R,CLAIM_VOUCHER:()=>v,SAVE_PLATFORM_VOUCHER_BY_VOUCHER_CODE:()=>O,FETCH_RECOMMEND_PLATFORM_VOUCHERS:()=>T,SET_VOUCHER_ACTIVE_FILTER_INDEX:()=>S,SET_SHOPEE_VOUCHER_ACTIVE_STATUS_INDEX:()=>g,FETCH_RECOMMEND_LITE_VOUCHERS:()=>V,FETCH_USER_VOUCHER_LIST:()=>H,VOUCHER_WALLET_INIT:()=>f,FETCH_VOUCHER_WALLET_RECOMMENDED_VOUCHERS:()=>A,GET_RECOMMENDED_VOUCHERS_BY_MODEL:()=>U});var s=o(60037);const c="FETCH_TABS",t=(0,s.n)("FETCH_VOUCHERS"),n=(0,s.n)("FETCH_RECOMMEND_VOUCHER"),E=(0,s.n)("VALIDATE_VOUCHERS"),_="ADD_RECOMMEND_VOUCHERS",u="MOVE_RECOMMEND_VOUCHER_TO_TOP",i=(0,s.n)("FETCH_PARTNER_VOUCHERS"),h=(0,s.n)("MARK_PARTNER_VOUCHER"),a=(0,s.n)("SAVE_VOUCHER"),p=(0,s.n)("FETCH_VOUCHER"),d=(0,s.n)("FETCH_BATCH_VOUCHER"),l=(0,s.n)("FETCH_BATCH_VOUCHER_LEGACY"),C="CREATE_BATCH_VOUCHER_REQ",m=(0,s.n)("FETCH_REDEEMED_VOUCHER_BY_TIME"),R="CREATE_FETCH_REDEEMED_VOUCHER_BY_TIME_REQ",v=(0,s.n)("CLAIM_VOUCHER"),O=(0,s.n)("SAVE_PLATFORM_VOUCHER_BY_VOUCHER_CODE"),T=(0,s.n)("FETCH_RECOMMEND_PLATFORM_VOUCHER"),S="SET_VOUCHER_ACTIVE_FILTER_INDEX",g="SET_SHOPEE_VOUCHER_ACTIVE_STATUS_INDEX",V=(0,s.n)("FETCH_RECOMMEND_LITE_VOUCHERS"),H=(0,s.n)("FETCH_USER_VOUCHER_LIST"),f="VOUCHER_WALLET_INIT",A=(0,s.n)("FETCH_VOUCHER_WALLET_RECOMMENDED_VOUCHERS"),U=(0,s.n)("GET_RECOMMENDED_VOUCHERS_BY_MODEL")},50104:(e,r,o)=>{"use strict";o.microfeA(e,(function(){return Promise.all([o.microfeM(0),o.microfeM(1),o.microfeM(2),o.microfeM(3),o.microfeM(4)]).then((function(){e.exports=r,o.a(e,(async e=>{o.d(r,{Z:()=>g});var s=o(63804),c=o.n(s),t=o(28567),n=o.n(t),E=o(84857),_=o(71574),u=o(49209),i=o(87789),h=o(30143),a=o(76676),p=o(25769),d=o(95325),l=o(2608),C=o(88270),m=o(20742),R=e([C]);C=(R.then?await R:R)[0];const v=["show","popoverProps","onFirstVoucherChange","onFirstVoucherClaimProgressChange"],O=["className"];function T(){return T=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},T.apply(this,arguments)}function S(e,r){if(null==e)return{};var o,s,c={},t=Object.keys(e);for(s=0;s<t.length;s++)o=t[s],r.indexOf(o)>=0||(c[o]=e[o]);return c}const g=(0,E.compose)(l.Z,a.t)((function(e){var r;const{show:o,popoverProps:t,onFirstVoucherChange:E,onFirstVoucherClaimProgressChange:a}=e,l=S(e,v),R=(null==(r=e.shopInfo)?void 0:r.shopid)||0,g=(0,d.useDispatch)();(0,u.N)({shopId:R,onFirstVoucherChange:E,onFirstVoucherClaimProgressChange:a});const V=e.platformVouchers.map((e=>T({},e,{promotion_id:e.promotionid})));if((0,s.useEffect)((()=>{if(o){const r=T({},(0,i.Gc)(e.validateInfo,R,e.isCoinApplied,V),{priority_promotion_ids:e.priorityPromotionIds,sorting_flag:_.O_.VOUCHER_RECOMMEND_SORT_FLAG_VOUCHER_DRAWER,isCheckout:e.isCheckout});g((0,h.u$)(r))}}),[o]),!o)return null;if(!t)return c().createElement(C.Z,l);const{className:H}=t,f=S(t,O);return c().createElement(c().Fragment,null,c().createElement(p.J2,T({className:n()(H,m.Z.popover)},f),c().createElement(C.Z,l)))}))}))}))}))},20742:(e,r,o)=>{"use strict";o.d(r,{Z:()=>s});const s={popover:"lTT4eh"}},96370:e=>{"use strict";var r;e.exports=(r="live",new Promise((function(e,o){"live"!=r&&"stable"!=r&&"liveish"!=r&&(r="live");var s,c,t,n="https://deo.shopeemobile.com/shopee/shopee-webfepromotion-"+r+"-sg/voucher-card@stable/"+(s="index.production",c="js",self.__ASSETS__&&self.__ASSETS__.VOUCHER_CARD_MANIFEST&&self.__ASSETS__.VOUCHER_CARD_MANIFEST[r]?[s,self.__ASSETS__.VOUCHER_CARD_MANIFEST[r],c].join("."):[s,c].join("."));(t=n,new Promise((function(e,r){var o=document.createElement("script");o.async=!1,o.defer=!0,o.crossOrigin="",o.src=t,o.onload=function(){e(window.VoucherCard)},o.onerror=r,document.body.appendChild(o)}))).then((function(r){e(r)}),o).catch((function(e){throw new Error("unable load voucher card"+e)}))})))},17:e=>{"use strict";e.exports=p},51408:e=>{"use strict";e.exports=i},71437:e=>{"use strict";e.exports=t},16161:r=>{"use strict";r.exports=e},86704:e=>{"use strict";e.exports=c},63804:e=>{"use strict";e.exports=r},67274:e=>{"use strict";e.exports=_},95325:e=>{"use strict";e.exports=o},56775:e=>{"use strict";e.exports=E},84857:e=>{"use strict";e.exports=s},57762:e=>{"use strict";e.exports=n}},function(r){"use strict";var o;o=r.x,r.x=()=>{Promise.resolve(r(50104)).then((r=>{e.setModule("pcmall-cartsellervoucherspopup",r.Z,{type:"slot",buildInformation:{updated:"2023-05-23T09:18:26.738Z",tag:"voucher-v1.5.0",branch:"heads/voucher-v1.5.0",lastCommit:"Merge branch '\\''staging'\\'' into '\\''release'\\''",lastCommitHash:"c3da68b4b1f2d94e1a620f32d8eb6650e5315835"},registerSentryDsn:!0,projectAndModuleName:"pcmall-voucher"}),o()}))}},[[50104,666,59,513,877,34,702,56,859,292]]])},2]),function(){if(window&&window.__DECKER_HOOK__){var e=window.__DECKER_HOOK__,r=function(){e.sendToDevtools("MFE_LOAD_SLOT",{slotName:"pcmall-cartsellervoucherspopup",updated:"2023-05-23T09:18:26.772Z",tag:"voucher-v1.5.0",branch:"heads/voucher-v1.5.0",lastCommit:"Merge branch '\\''staging'\\'' into '\\''release'\\''",lastCommitHash:"c3da68b4b1f2d94e1a620f32d8eb6650e5315835"})};e.on("MFE_RETRIEVE_SLOTS",r),r()}}();
//# sourceMappingURL=https://sourcemap.webfe.shopeemobile.com/pcmall-voucher/_/pcmall-cartsellervoucherspopup.ddcc1ac0b4d52e161591.js.map